{
  "title": "iYup Dashboard",
  "timezone": "browser",
  "schemaVersion": 36,
  "version": 2,
  "refresh": "5s",
  "panels": [
    {
      "type": "stat",
      "title": "Total API Requests (5m)",
      "id": 1,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(increase(api_gateway_requests_total[5m]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 0,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Successful Pings (5m) - google.com",
      "id": 2,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(increase(ping_success_total{target=\"https://google.com\"}[5m]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "gray",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 3,
        "y": 0,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Successful Pings (5m) - github.com",
      "id": 3,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(increase(ping_success_total{target=\"https://github.com\"}[5m]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "gray",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 0,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Availability % (5m) - google.com",
      "id": 4,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "100 * increase(ping_success_total{target=\"https://google.com\"}[5m]) / clamp_min(increase(ping_success_total{target=\"https://google.com\"}[5m]) + increase(ping_failure_total{target=\"https://google.com\"}[5m]), 1)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "orange",
                "value": 95
              },
              {
                "color": "green",
                "value": 99
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 9,
        "y": 0,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Availability % (5m) - github.com",
      "id": 21,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "100 * increase(ping_success_total{target=\"https://github.com\"}[5m]) / clamp_min(increase(ping_success_total{target=\"https://github.com\"}[5m]) + increase(ping_failure_total{target=\"https://github.com\"}[5m]), 1)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "orange",
                "value": 95
              },
              {
                "color": "green",
                "value": 99
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 4,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Failed Pings (5m) - google.com",
      "id": 22,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(increase(ping_failure_total{target=\"https://google.com\"}[5m]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 1
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 3,
        "y": 4,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Failed Pings (5m) - github.com",
      "id": 23,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(increase(ping_failure_total{target=\"https://github.com\"}[5m]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 1
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 4,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "API Error % (5m)",
      "id": 14,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "100 * sum(rate(api_gateway_requests_total{status=~\"5..\"}[5m])) / clamp_min(sum(rate(api_gateway_requests_total[5m])), 1)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "orange",
                "value": 1
              },
              {
                "color": "red",
                "value": 5
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 9,
        "y": 4,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "timeseries",
      "title": "Requests by Status (rate)",
      "id": 5,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum by (status) (rate(api_gateway_requests_total[$__rate_interval]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 8,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "API 5xx Rate (5m)",
      "id": 13,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(api_gateway_requests_total{status=~\"5..\"}[5m]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 8,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "Ping Success/Failures (rate) - google.com",
      "id": 6,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "rate(ping_success_total{target=\"https://google.com\"}[$__rate_interval])",
          "refId": "A"
        },
        {
          "expr": "rate(ping_failure_total{target=\"https://google.com\"}[$__rate_interval])",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 14,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "Ping Success/Failures (rate) - github.com",
      "id": 24,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "rate(ping_success_total{target=\"https://github.com\"}[$__rate_interval])",
          "refId": "A"
        },
        {
          "expr": "rate(ping_failure_total{target=\"https://github.com\"}[$__rate_interval])",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 14,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "bargauge",
      "title": "Requests by Path (5m)",
      "id": 7,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum by (path) (increase(api_gateway_requests_total[5m]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 20,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "heatmap",
      "title": "API Latency Histogram (bucket rate)",
      "id": 8,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(api_gateway_request_duration_seconds_bucket[5m])) by (le)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 20,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "heatmap",
      "title": "Ping Latency Histogram (1m rate) - google.com",
      "id": 9,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(ping_latency_seconds_bucket{target=\"https://google.com\"}[1m])) by (le)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 26,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "heatmap",
      "title": "Ping Latency Histogram (1m rate) - github.com",
      "id": 25,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(ping_latency_seconds_bucket{target=\"https://github.com\"}[1m])) by (le)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 26,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "Average Ping Latency (s) - google.com",
      "id": 10,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(ping_latency_seconds_sum{target=\"https://google.com\"}[$__rate_interval])) / clamp_min(sum(rate(ping_latency_seconds_count{target=\"https://google.com\"}[$__rate_interval])), 1)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 32,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "Average Ping Latency (s) - github.com",
      "id": 26,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(ping_latency_seconds_sum{target=\"https://github.com\"}[$__rate_interval])) / clamp_min(sum(rate(ping_latency_seconds_count{target=\"https://github.com\"}[$__rate_interval])), 1)",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 32,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "API Request Count (rate by path)",
      "id": 11,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum by (path) (rate(api_gateway_requests_total[$__rate_interval]))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 38,
        "w": 8,
        "h": 6
      }
    },
    {
      "type": "stat",
      "title": "Alerts Firing",
      "id": 15,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(ALERTS{alertstate=\"firing\"})",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 1
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 8,
        "y": 38,
        "w": 4,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "Ping Latency p95 (5m) - google.com",
      "id": 16,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum by (le) (rate(ping_latency_seconds_bucket{target=\"https://google.com\"}[5m])))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 44,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "timeseries",
      "title": "Ping Latency p95 (5m) - github.com",
      "id": 27,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum by (le) (rate(ping_latency_seconds_bucket{target=\"https://github.com\"}[5m])))",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 44,
        "w": 6,
        "h": 6
      }
    },
    {
      "type": "stat",
      "title": "Scrape Up (ping-agent)",
      "id": 18,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "max(up{job=\"ping-agent\"})",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 0,
        "y": 50,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Scrape Up (api-gateway)",
      "id": 19,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "max(up{job=\"api-gateway\"})",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {
            "mode": "thresholds"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "x": 3,
        "y": 50,
        "w": 3,
        "h": 4
      }
    },
    {
      "type": "timeseries",
      "title": "Scrape Duration (s)",
      "id": 20,
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "scrape_duration_seconds{job=~\"ping-agent|api-gateway\"}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "x": 6,
        "y": 50,
        "w": 6,
        "h": 4
      }
    }
  ],
  "templating": {
    "list": []
  }
}